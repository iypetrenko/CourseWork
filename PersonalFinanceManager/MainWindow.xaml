<Window x:Class="PersonalFinanceManager.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PersonalFinanceManager.Views"
        xmlns:viewmodels="clr-namespace:PersonalFinanceManager.ViewModels"
        mc:Ignorable="d"
        Title="Personal Finance Manager" Height="450" Width="800">

    <!-- Define a View resource with proper instance of the MainViewModel -->
    <Window.Resources>
        <viewmodels:MainViewModel x:Key="ViewModel"/>
    </Window.Resources>

    <!-- We'll comment this out since the DataContext is set from code-behind -->
    <!--<Window.DataContext>
        <StaticResource ResourceKey="ViewModel"/>
    </Window.DataContext>-->

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with balance -->
        <StackPanel Grid.Row="0" Margin="10">
            <TextBlock Text="Current Balance:" FontWeight="Bold"/>
            <TextBlock Text="{Binding CurrentBalance, StringFormat='{}{0:C}'}" FontSize="18"/>
        </StackPanel>

        <!-- Main content with transactions -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <!-- Transaction list -->
            <GroupBox Grid.Column="0" Header="Transactions" Margin="5">
                <ListView ItemsSource="{Binding Transactions}" 
                          SelectedItem="{Binding SelectedTransaction}">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Date" 
                                            DisplayMemberBinding="{Binding Date, StringFormat='{}{0:d}'}"/>
                            <GridViewColumn Header="Description" 
                                            DisplayMemberBinding="{Binding Description}"/>
                            <GridViewColumn Header="Amount" 
                                            DisplayMemberBinding="{Binding Amount, StringFormat='{}{0:C}'}"/>
                        </GridView>
                    </ListView.View>
                </ListView>
            </GroupBox>

            <!-- Categories list -->
            <GroupBox Grid.Column="1" Header="Categories" Margin="5">
                <ListView ItemsSource="{Binding Categories}" 
                          SelectedItem="{Binding SelectedCategory}">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}"/>
                        </GridView>
                    </ListView.View>
                </ListView>
            </GroupBox>
        </Grid>

        <!-- Footer with buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="10" HorizontalAlignment="Right">
            <Button Content="Add Category" Command="{Binding AddCategoryCommand}" 
                    Margin="5" Padding="10,5"/>
            <Button Content="Add Transaction" Command="{Binding AddTransactionCommand}" 
                    Margin="5" Padding="10,5"/>
            <Button Content="Delete Transaction" Command="{Binding DeleteTransactionCommand}" 
                    Margin="5" Padding="10,5"/>
        </StackPanel>
    </Grid>
</Window>